---
- name: "InformaciÃ³n bÃ¡sica del sistema"
  hosts: all
  gather_facts: yes
  connection: local
  
  tasks:
    - name: "Mostrar informaciÃ³n del sistema"
      debug:
        msg: |
          ğŸ–¥ï¸ Sistema: {{ ansible_distribution | default('Unknown') }} {{ ansible_distribution_version | default('') }}
          ğŸ’¾ Memoria total: {{ (ansible_memtotal_mb | default(0) / 1024) | round(1) }} GB
          ğŸ”§ Procesador: {{ ansible_processor_cores | default('Unknown') }} cores
          ğŸ  Usuario actual: {{ ansible_user_id | default('Unknown') }}
          ğŸ“… Fecha: {{ ansible_date_time.date }}
          â° Hora: {{ ansible_date_time.time }}
          ğŸŒ Hostname: {{ ansible_hostname | default('Unknown') }}

    - name: "Verificar espacio en disco"
      shell: df -h /
      register: espacio_disco
      
    - name: "Mostrar espacio en disco"
      debug:
        msg: "ğŸ’½ Espacio en disco: {{ espacio_disco.stdout_lines[1] }}"

    - name: "Mostrar variables disponibles (debug)"
      debug:
        msg: "ğŸ” EjecutÃ¡ndose en: {{ ansible_distribution | default('Container') }}"

    - name: "Crear archivo de reporte simple"
      copy:
        content: |
          REPORTE DEL SISTEMA - {{ ansible_date_time.date }} {{ ansible_date_time.time }}
          ============================================================
          
          Sistema: {{ ansible_distribution | default('Unknown') }} {{ ansible_distribution_version | default('') }}
          Memoria: {{ (ansible_memtotal_mb | default(0) / 1024) | round(1) }} GB
          Procesador: {{ ansible_processor_cores | default('Unknown') }} cores
          Usuario: {{ ansible_user_id | default('Unknown') }}
          Hostname: {{ ansible_hostname | default('Unknown') }}
          
          Espacio en Disco:
          {{ espacio_disco.stdout }}
          
          Estado: âœ… Playbook ejecutado correctamente desde AWX
          
        dest: "/tmp/reporte-awx-{{ ansible_date_time.date }}.txt"
        
    - name: "Confirmar Ã©xito"
      debug:
        msg: "ğŸ‰ Â¡Playbook ejecutado exitosamente! Reporte guardado en /tmp/reporte-awx-{{ ansible_date_time.date }}.txt" 